<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ñ—É—Ä–Ω–∞–ª –º–∞—Å—Ç–µ—Ä–∞ Schindler</title>
    <link href="https://fonts.googleapis.com/css2?family=Caveat:wght@700&family=Roboto:wght@300;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --orange: #FF8C42;
            --dark-orange: #E67E22;
            --light-orange: #FFD3B5;
            --accent: #2D2D2D;
            --silk: #FFF3E0;
            --shadow: rgba(0,0,0,0.1);
            --green: #4CAF50;
            --red: #F44336;
        }

        body {
            font-family: 'Roboto', sans-serif;
            background: var(--silk);
            color: var(--accent);
            margin: 0;
            padding: 20px;
        }

        .header-section {
            text-align: center;
            margin: 50px 0;
        }

        .main-title {
            font-family: 'Caveat', cursive;
            font-size: 3.5rem;
            color: var(--orange);
            margin: 0;
            text-shadow: 2px 2px 4px var(--shadow);
        }

        .sub-title {
            font-family: 'Caveat', cursive;
            font-size: 2rem;
            color: var(--accent);
            margin-top: 10px;
        }

        .grid-system {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            max-width: 1200px;
            margin: auto;
        }

        .card {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 4px 15px var(--shadow);
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .card.completed {
            opacity: 0.7;
            background: #f5f5f5;
        }

        .card.completed h3 {
            text-decoration: line-through;
        }

        .card:hover {
            transform: translateY(-5px);
        }

        .card-actions {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 15px;
        }

        .action-button {
            padding: 8px 15px;
            border-radius: 20px;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .action-button.complete {
            background: var(--green);
            color: white;
        }

        .action-button.delete {
            background: var(--red);
            color: white;
        }

        .action-button:hover {
            transform: scale(1.05);
        }

        .fab-container {
            position: fixed;
            bottom: 30px;
            right: 30px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .fab-button {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 4px 15px var(--shadow);
            transition: all 0.3s ease;
            position: relative;
        }

        .fab-button.project {
            background: var(--orange);
        }

        .fab-button.part {
            background: var(--green);
        }

        .fab-button::after {
            content: '+';
            font-size: 32px;
            color: white;
            font-family: 'Caveat', cursive;
        }

        .fab-label {
            position: absolute;
            right: 75px;
            background: white;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.9rem;
            opacity: 0;
            transition: opacity 0.3s ease;
            pointer-events: none;
            box-shadow: 0 2px 8px var(--shadow);
        }

        .fab-button:hover {
            transform: scale(1.1) rotate(90deg);
        }

        .fab-button:hover .fab-label {
            opacity: 1;
        }

        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal {
            background: white;
            padding: 30px;
            border-radius: 20px;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal h2 {
            font-family: 'Caveat', cursive;
            color: var(--orange);
            font-size: 2rem;
        }

        .modal input, .modal textarea, .modal select {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border: 1px solid var(--light-orange);
            border-radius: 10px;
            font-family: 'Roboto', sans-serif;
        }

        .modal button {
            background: var(--orange);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 10px;
            cursor: pointer;
            margin: 5px;
        }

        .modal button:hover {
            background: var(--dark-orange);
        }

        .handwriting {
            font-family: 'Caveat', cursive;
            color: var(--orange);
            font-size: 1.4rem;
        }

        .confirm-modal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 20px;
            border-radius: 10px;
            z-index: 1001;
            box-shadow: 0 4px 8px var(--shadow);
            display: none;
        }

        .confirm-buttons {
            margin-top: 20px;
            display: flex;
            justify-content: space-around;
        }

        .confirm-buttons button {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .confirm-buttons button:nth-child(1) {
            background: var(--green);
            color: white;
        }

        .confirm-buttons button:nth-child(2) {
            background: var(--red);
            color: white;
        }

        .select-collaborators {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .select-collaborators label {
            display: flex;
            align-items: center;
        }

        .select-collaborators input[type="checkbox"] {
            margin-right: 5px;
        }
    </style>
</head>
<body>

<div class="header-section">
    <h1 class="main-title">–ñ—É—Ä–Ω–∞–ª –º–∞—Å—Ç–µ—Ä–∞</h1>
    <div class="sub-title">Schindler ¬∑ –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è –¥–ª—è –ª–∏—Ñ—Ç–æ–≤</div>
</div>

<div class="grid-system">
    <div class="card">
        <h2>üèó –ê–∫—Ç–∏–≤–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã</h2>
        <div id="projectsList"></div>
    </div>

    <div class="card">
        <h2>üî© –ö–∞—Ç–∞–ª–æ–≥ –¥–µ—Ç–∞–ª–µ–π</h2>
        <div id="partsList"></div>
    </div>
</div>

<div class="fab-container">
    <div class="fab-button project" onclick="showNewProjectForm()">
        <span class="fab-label">–ù–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç</span>
    </div>
    <div class="fab-button part" onclick="showNewPartForm()">
        <span class="fab-label">–ù–æ–≤–∞—è –¥–µ—Ç–∞–ª—å</span>
    </div>
</div>

<div class="modal-overlay" id="projectModal">
    <div class="modal">
        <h2 class="handwriting">–î–µ—Ç–∞–ª–∏ –ø—Ä–æ–µ–∫—Ç–∞</h2>
        <input type="text" id="projectTitle" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞">
        <textarea id="projectDescription" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ —Ä–∞–±–æ—Ç..."></textarea>
        <input type="text" id="projectLiftType" placeholder="–¢–∏–ø –ª–∏—Ñ—Ç–∞">
        <input type="text" id="projectLiftModel" placeholder="–ú–æ–¥–µ–ª—å –ª–∏—Ñ—Ç–∞">
        <div class="select-collaborators" id="collaboratorsList"></div>
        <input type="text" id="newCollaborator" placeholder="–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–≥–æ –∫–æ–ª–ª–µ–≥—É">
        <button class="action-button complete" onclick="addCollaborator()">–î–æ–±–∞–≤–∏—Ç—å</button>
        <input type="text" id="projectLocation" placeholder="–ì–¥–µ —è —Ä–∞–±–æ—Ç–∞–ª">
        
        <h3>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ –¥–µ—Ç–∞–ª–∏</h3>
        <div id="usedParts"></div>
        <button class="action-button complete" onclick="addPartToProject()">‚ûï –î–æ–±–∞–≤–∏—Ç—å –¥–µ—Ç–∞–ª—å</button>
        
        <h3>–ó–∞–∫—É–ø–∫–∏</h3>
        <div id="purchasedParts"></div>
        
        <button class="action-button complete" onclick="saveProject()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        <button class="action-button delete" onclick="closeModal()">‚ùå –ó–∞–∫—Ä—ã—Ç—å</button>
    </div>
</div>

<div class="modal-overlay" id="partModal">
    <div class="modal">
        <h2 class="handwriting">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–µ—Ç–∞–ª–∏</h2>
        <input type="text" id="partName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –¥–µ—Ç–∞–ª–∏">
        <textarea id="partDescription" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ..."></textarea>
        <input type="number" id="partQuantity" placeholder="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ">
        <input type="text" id="partLiftCompatibility" placeholder="–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å –ª–∏—Ñ—Ç–∞–º–∏">
        <button class="action-button complete" onclick="savePart()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        <button class="action-button delete" onclick="closeModal()">‚ùå –ó–∞–∫—Ä—ã—Ç—å</button>
    </div>
</div>

<div class="confirm-modal" id="confirmModal">
    <p id="confirmMessage">–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç—É –¥–µ—Ç–∞–ª—å?</p>
    <div class="confirm-buttons">
        <button onclick="confirmDelete()">–î–∞</button>
        <button onclick="cancelDelete()">–ù–µ—Ç</button>
    </div>
</div>

<script>
    let projects = JSON.parse(localStorage.getItem('projects')) || [];
    let parts = JSON.parse(localStorage.getItem('parts')) || [];
    let collaborators = JSON.parse(localStorage.getItem('collaborators')) || [];
    let currentProject = null;
    let itemToDelete = null;

    function init() {
        renderProjects();
        renderParts();
        checkMonthlyUpdate();
    }

    function renderProjects() {
        const list = document.getElementById('projectsList');
        list.innerHTML = projects.map(project => `
            <div class="card ${project.completed ? 'completed' : ''}" onclick="openProject('${project.id}')">
                <h3>${project.title}</h3>
                <p>${new Date(project.date).toLocaleDateString()}</p>
                <p class="handwriting">–¢–∏–ø –ª–∏—Ñ—Ç–∞: ${project.liftType || '–ù–µ —É–∫–∞–∑–∞–Ω'}, –ú–æ–¥–µ–ª—å: ${project.liftModel || '–ù–µ —É–∫–∞–∑–∞–Ω–∞'}</p>
                <p class="handwriting">–° –∫–µ–º —Ä–∞–±–æ—Ç–∞–ª: ${project.collaborators.join(', ') || '–ù–µ —É–∫–∞–∑–∞–Ω–æ'}, –ì–¥–µ —Ä–∞–±–æ—Ç–∞–ª: ${project.location || '–ù–µ —É–∫–∞–∑–∞–Ω–æ'}</p>
                <p class="handwriting">${project.description || '–û–ø–∏—Å–∞–Ω–∏–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç'}</p>
                <div class="card-actions">
                    ${!project.completed ? `
                        <button class="action-button complete" onclick="completeProject('${project.id}')">‚úÖ –ó–∞–≤–µ—Ä—à–∏—Ç—å</button>
                    ` : ''}
                    <button class="action-button delete" onclick="confirmDeleteProject('${project.id}')">üóë –£–¥–∞–ª–∏—Ç—å</button>
                </div>
            </div>
        `).join('');
    }

    function renderParts() {
        const list = document.getElementById('partsList');
        list.innerHTML = parts.map(part => `
            <div class="card" onclick="openPart('${part.id}')">
                <h3>${part.name}</h3>
                <p>–û—Å—Ç–∞—Ç–æ–∫: ${part.quantity}</p>
                <p class="handwriting">–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å: ${part.liftCompatibility || '–ù–µ —É–∫–∞–∑–∞–Ω–∞'}</p>
                <p class="handwriting">${part.description || '–û–ø–∏—Å–∞–Ω–∏–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç'}</p>
                <div class="card-actions">
                    <button class="action-button delete" onclick="confirmDeletePart('${part.id}')">üóë –£–¥–∞–ª–∏—Ç—å</button>
                </div>
            </div>
        `).join('');
    }

    function renderCollaborators() {
        const list = document.getElementById('collaboratorsList');
        list.innerHTML = collaborators.map(collab => `
            <label>
                <input type="checkbox" name="collaborator" value="${collab}" ${currentProject && currentProject.collaborators.includes(collab) ? 'checked' : ''}>
                ${collab}
            </label>
        `).join('');
    }

    function completeProject(id) {
        const project = projects.find(p => p.id === id);
        project.completed = true;
        saveData();
        renderProjects();
    }

    function confirmDeleteProject(id) {
        itemToDelete = { type: 'project', id };
        document.getElementById('confirmMessage').textContent = "–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç?";
        document.getElementById('confirmModal').style.display = 'block';
    }

    function confirmDeletePart(id) {
        itemToDelete = { type: 'part', id };
        document.getElementById('confirmMessage').textContent = "–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç—É –¥–µ—Ç–∞–ª—å?";
        document.getElementById('confirmModal').style.display = 'block';
    }

    function confirmDelete() {
        if (itemToDelete.type === 'project') {
            deleteProject(itemToDelete.id);
        } else if (itemToDelete.type === 'part') {
            deletePart(itemToDelete.id);
        }
        document.getElementById('confirmModal').style.display = 'none';
        itemToDelete = null;
    }

    function cancelDelete() {
        document.getElementById('confirmModal').style.display = 'none';
        itemToDelete = null;
    }

    function deleteProject(id) {
        projects = projects.filter(p => p.id !== id);
        saveData();
        renderProjects();
    }

    function deletePart(id) {
        parts = parts.filter(p => p.id !== id);
        saveData();
        renderParts();
    }

    function checkMonthlyUpdate() {
        const lastUpdate = localStorage.getItem('lastUpdate');
        const currentDate = new Date();
        
        if (!lastUpdate || new Date(lastUpdate).getMonth() !== currentDate.getMonth()) {
            projects.forEach(p => {
                if (!p.completed) {
                    p.status = '–ü–µ—Ä–µ–Ω–µ—Å–µ–Ω–æ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π –º–µ—Å—è—Ü';
                }
            });
            localStorage.setItem('lastUpdate', currentDate.toISOString());
            saveData();
            renderProjects();
        }
    }

    function saveData() {
        localStorage.setItem('projects', JSON.stringify(projects));
        localStorage.setItem('parts', JSON.stringify(parts));
        localStorage.setItem('collaborators', JSON.stringify(collaborators));
    }

    function showNewProjectForm() {
        const newProject = {
            id: Date.now().toString(),
            title: '–ù–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç',
            date: new Date().toISOString(),
            description: '',
            liftType: '',
            liftModel: '',
            collaborators: [],
            location: ''
        };
        projects.push(newProject);
        openProject(newProject.id);
    }

    function showNewPartForm() {
        const newPart = {
            id: Date.now().toString(),
            name: '–ù–æ–≤–∞—è –¥–µ—Ç–∞–ª—å',
            description: '',
            quantity: 0,
            liftCompatibility: ''
        };
        parts.push(newPart);
        openPart(newPart.id);
    }

    function openProject(id) {
        currentProject = projects.find(p => p.id === id);
        document.getElementById('projectTitle').value = currentProject.title;
        document.getElementById('projectDescription').value = currentProject.description;
        document.getElementById('projectLiftType').value = currentProject.liftType || '';
        document.getElementById('projectLiftModel').value = currentProject.liftModel || '';
        renderCollaborators(); // Update collaborators list
        document.getElementById('projectLocation').value = currentProject.location || '';
        showModal('projectModal');
    }

    function openPart(id) {
        const part = parts.find(p => p.id === id);
        document.getElementById('partName').value = part.name;
        document.getElementById('partDescription').value = part.description;
        document.getElementById('partQuantity').value = part.quantity;
        document.getElementById('partLiftCompatibility').value = part.liftCompatibility || '';
        showModal('partModal');
    }

    function addPartToProject() {
        const partSelect = document.createElement('select');
        partSelect.innerHTML = parts.map(part => `<option value="${part.id}">${part.name}</option>`);
        
        const quantityInput = document.createElement('input');
        quantityInput.type = 'number';
        quantityInput.placeholder = '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ';

        const container = document.createElement('div');
        container.append(partSelect, quantityInput);
        document.getElementById('usedParts').appendChild(container);
    }

    function addCollaborator() {
        const newCollab = document.getElementById('newCollaborator').value.trim();
        if (newCollab && !collaborators.includes(newCollab)) {
            collaborators.push(newCollab);
            renderCollaborators();
            document.getElementById('newCollaborator').value = '';
        }
    }

    function saveProject() {
        currentProject.title = document.getElementById('projectTitle').value;
        currentProject.description = document.getElementById('projectDescription').value;
        currentProject.liftType = document.getElementById('projectLiftType').value;
        currentProject.liftModel = document.getElementById('projectLiftModel').value;
        currentProject.collaborators = Array.from(document.querySelectorAll('input[name="collaborator"]:checked')).map(checkbox => checkbox.value);
        currentProject.location = document.getElementById('projectLocation').value;
        saveData();
        renderProjects();
        closeModal();
    }

    function savePart() {
        const part = {
            id: Date.now().toString(),
            name: document.getElementById('partName').value,
            description: document.getElementById('partDescription').value,
            quantity: document.getElementById('partQuantity').value,
            liftCompatibility: document.getElementById('partLiftCompatibility').value
        };
        parts.push(part);
        saveData();
        renderParts();
        closeModal();
    }

    function showModal(type) {
        document.getElementById(type).style.display = 'flex';
    }

    function closeModal() {
        document.querySelectorAll('.modal-overlay').forEach(m => m.style.display = 'none');
    }

    window.onload = init;
    setInterval(checkMonthlyUpdate, 86400000); // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å
</script>

</body>
</html>
